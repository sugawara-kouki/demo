<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:fragment="layout(title, content)">
<head>
    <meta charset="UTF-8">
    <title th:replace="${title}">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¿ã‚¤ãƒˆãƒ«</title>
    <!-- å„ç¨®CSSãƒ©ã‚¤ãƒ–ãƒ©ãƒª -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.5/dist/sweetalert2.min.css">
    <!-- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã‚¹ã‚¿ã‚¤ãƒ« -->
    <style>
        .celebration-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            opacity: 0;
        }
        @keyframes fall {
            0% {
                opacity: 1;
                top: -10%;
                transform: translateX(0) rotate(0deg);
            }
            100% {
                opacity: 0.3;
                top: 100%;
                transform: translateX(100px) rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå…¥ã‚‹å ´æ‰€ -->
    <div th:replace="${content}">
        ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã“ã“ã«å…¥ã‚Šã¾ã™
    </div>
    
    <!-- ç´™å¹é›ªç”¨ã‚³ãƒ³ãƒ†ãƒŠ -->
    <div id="celebrationContainer" class="celebration-container"></div>
    
    <!-- JavaScript ãƒ©ã‚¤ãƒ–ãƒ©ãƒª -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.5/dist/sweetalert2.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
    
    <!-- ã“ã“ã«ã‚ãªãŸãŒè²¼ã‚Šä»˜ã‘ãŸJavaScriptãŒå…¥ã‚Šã¾ã™ -->
    <script th:inline="javascript">
        // URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—
        const urlParams = new URLSearchParams(window.location.search);
        const successParam = urlParams.get('success');
        const actionParam = urlParams.get('action');
        
        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–¢é€£ã®é–¢æ•°
        function createConfetti() {
            const container = document.getElementById('celebrationContainer');
            container.innerHTML = '';
            
            const colors = ['#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#FF00FF', '#00FFFF'];
            const confettiCount = 200;
            
            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.top = -Math.random() * 20 + '%';
                confetti.style.width = Math.random() * 10 + 5 + 'px';
                confetti.style.height = Math.random() * 10 + 5 + 'px';
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                confetti.style.animation = 'fall ' + (Math.random() * 3 + 2) + 's linear forwards';
                confetti.style.animationDelay = Math.random() * 2 + 's';
                
                container.appendChild(confetti);
            }
            
            setTimeout(() => {
                container.innerHTML = '';
            }, 7000);
        }
        
        function playCelebrationAnimation(action) {
            // SweetAlert2 ã§æ´¾æ‰‹ãªã‚¢ãƒ©ãƒ¼ãƒˆ
            let title, text, icon, background;
            
            switch(action) {
                case 'create':
                    title = 'ä½œæˆæˆåŠŸï¼ğŸ‰';
                    text = 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã¾ã—ãŸï¼';
                    icon = 'success';
                    background = 'linear-gradient(45deg, #FF9A8B, #FF6A88, #FF99AC)';
                    break;
                case 'update':
                    title = 'æ›´æ–°å®Œäº†ï¼ğŸš€';
                    text = 'ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãŒæ­£å¸¸ã«æ›´æ–°ã•ã‚Œã¾ã—ãŸï¼';
                    icon = 'success';
                    background = 'linear-gradient(45deg, #84FAB0, #8FD3F4)';
                    break;
                case 'delete':
                    title = 'å‰Šé™¤å®Œäº†ï¼ğŸ’¥';
                    text = 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ­£å¸¸ã«å‰Šé™¤ã•ã‚Œã¾ã—ãŸï¼';
                    icon = 'success';
                    background = 'linear-gradient(45deg, #FBDA61, #FF5ACD)';
                    break;
                default:
                    title = 'æ“ä½œæˆåŠŸï¼ğŸŒŸ';
                    text = 'å‡¦ç†ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸï¼';
                    icon = 'success';
                    background = 'linear-gradient(45deg, #A9C9FF, #FFBBEC)';
            }
            
            // ç´™å¹é›ªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            createConfetti();
            
            // ç”»é¢ã‚·ã‚§ã‚¤ã‚¯
            anime({
                targets: 'body',
                translateX: [
                    { value: -10, duration: 100, delay: 0 },
                    { value: 10, duration: 100, delay: 0 },
                    { value: -10, duration: 100, delay: 0 },
                    { value: 10, duration: 100, delay: 0 },
                    { value: -5, duration: 100, delay: 0 },
                    { value: 5, duration: 100, delay: 0 },
                    { value: 0, duration: 100, delay: 0 }
                ],
                easing: 'easeInOutSine'
            });
            
            // SweetAlert2 ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            Swal.fire({
                title: title,
                text: text,
                icon: icon,
                confirmButtonText: 'OK!',
                background: background,
                backdrop: `
                    rgba(0,0,123,0.4)
                    url("https://sweetalert2.github.io/images/nyan-cat.gif")
                    left top
                    no-repeat
                `,
                showClass: {
                    popup: 'animate__animated animate__zoomInDown'
                },
                hideClass: {
                    popup: 'animate__animated animate__zoomOutUp'
                }
            });
        }
        
        // URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
        if (successParam === 'true' && actionParam) {
            playCelebrationAnimation(actionParam);
            
            // URLã‹ã‚‰æˆåŠŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰Šé™¤ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã®æ›´æ–°æ™‚ã«å†åº¦ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒå®Ÿè¡Œã•ã‚Œãªã„ã‚ˆã†ã«ï¼‰
            const url = new URL(window.location.href);
            url.searchParams.delete('success');
            url.searchParams.delete('action');
            window.history.replaceState({}, document.title, url);
        }
    </script>
</body>
</html>